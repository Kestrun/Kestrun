---
title: Additional and Pattern Properties
parent: OpenApi
nav_order: 25
layout: default
---

# Additional and Pattern Properties

Model dynamic key/value objects using `additionalProperties` and `patternProperties`.

## Full source

File: [`pwsh/tutorial/examples/10.24-OpenAPI-Additional-Pattern-Properties.ps1`][10.24-OpenAPI-Additional-Pattern-Properties.ps1]

```powershell
{% include examples/pwsh/10.24-OpenAPI-Additional-Pattern-Properties.ps1 %}
```

## Step-by-step

1. **Logging**: Register the console logger and set the default level.
2. **Server**: Create a new Kestrun server and bind to a port.
3. **OpenAPI Info**: Add title, version, and description metadata.
4. **Pattern properties**: Define `InventoryCounts` using `OpenApiPatternProperties` to constrain keys by regex.
5. **Additional properties**: Define `FeatureFlags` and `CatalogUpdateRequest` with typed `AdditionalProperties`.
6. **GET endpoints**: Return sample data for inventory and feature flags.
7. **POST endpoint**: Accept catalog updates and return an echoed response.
8. **OpenAPI build + run**: Build/validate the document and start the server.

## Try it

```powershell
# Inventory counts (pattern properties)
curl http://127.0.0.1:5000/inventory/counts

# Feature flags (additional properties)
curl http://127.0.0.1:5000/features/flags

# Catalog update (POST)
curl -X POST http://127.0.0.1:5000/catalog/update `
  -H "Content-Type: application/json" `
  -d '{
    "itemId": "SKU-1001",
    "inventory": {
      "available": 120,
      "reserved": 8,
      "backorder": 3
    },
    "flags": {
      "betaPricing": true,
      "allowBackorder": false
    },
    "source": "batch-1"
  }'
```

PowerShell equivalent for POST:

```powershell
$body = @{
    itemId = 'SKU-1001'
    inventory = @{ available = 120; reserved = 8; backorder = 3 }
    flags = @{ betaPricing = $true; allowBackorder = $false }
    source = 'batch-1'
} | ConvertTo-Json -Depth 10

Invoke-WebRequest -Uri http://127.0.0.1:5000/catalog/update `
    -Method Post `
    -Headers @{ 'Content-Type' = 'application/json' } `
    -Body $body | Select-Object StatusCode, Content
```

## Troubleshooting

- **Additional keys missing in responses**: Return `AdditionalProperties` (or build a payload from it) to emit a flat JSON object.
- **400 on POST**: Ensure `Content-Type: application/json` is set and the request body includes required fields.
- **Pattern keys ignored**: Verify the regex in `OpenApiPatternProperties` matches the keys you send.

## References

- [Add-KrOpenApiInfo][Add-KrOpenApiInfo]
- [Add-KrOpenApiRoute][Add-KrOpenApiRoute]
- [Add-KrApiDocumentationRoute][Add-KrApiDocumentationRoute]
- [Build-KrOpenApiDocument][Build-KrOpenApiDocument]
- [Test-KrOpenApiDocument][Test-KrOpenApiDocument]
- [Write-KrResponse][Write-KrResponse]
- [OpenApiPath][OpenApiPath]
- [OpenApiResponse][OpenApiResponse]
- [OpenApiRequestBody][OpenApiRequestBody]
- [OpenApiSchemaComponent][OpenApiSchemaComponent]
- [OpenApiPatternProperties][OpenApiPatternProperties]
- [New-KrServer][New-KrServer]
- [Add-KrEndpoint][Add-KrEndpoint]
- [Enable-KrConfiguration][Enable-KrConfiguration]
- [Start-KrServer][Start-KrServer]
- [OpenAPI Guide][OpenAPI Guide]

---

### Previous / Next

{: .fs-4 .fw-500}

Previous: [RFC 6570 Variable Mapping](./24.RFC6570-Variable-Mapping)
Next: [Razor](../11.razor/index)

[10.24-OpenAPI-Additional-Pattern-Properties.ps1]: /pwsh/tutorial/examples/10.24-OpenAPI-Additional-Pattern-Properties.ps1
[Add-KrOpenApiInfo]: /pwsh/cmdlets/Add-KrOpenApiInfo
[Add-KrOpenApiRoute]: /pwsh/cmdlets/Add-KrOpenApiRoute
[Add-KrApiDocumentationRoute]: /pwsh/cmdlets/Add-KrApiDocumentationRoute
[Build-KrOpenApiDocument]: /pwsh/cmdlets/Build-KrOpenApiDocument
[Test-KrOpenApiDocument]: /pwsh/cmdlets/Test-KrOpenApiDocument
[Write-KrResponse]: /pwsh/cmdlets/Write-KrResponse
[OpenApiPath]: /pwsh/cmdlets/OpenApiPath
[OpenApiResponse]: /pwsh/cmdlets/OpenApiResponse
[OpenApiRequestBody]: /pwsh/cmdlets/OpenApiRequestBody
[OpenApiSchemaComponent]: /pwsh/cmdlets/OpenApiSchemaComponent
[OpenApiPatternProperties]: /pwsh/cmdlets/OpenApiPatternProperties
[New-KrServer]: /pwsh/cmdlets/New-KrServer
[Add-KrEndpoint]: /pwsh/cmdlets/Add-KrEndpoint
[Enable-KrConfiguration]: /pwsh/cmdlets/Enable-KrConfiguration
[Start-KrServer]: /pwsh/cmdlets/Start-KrServer
[OpenAPI Guide]: /guides/openapi
