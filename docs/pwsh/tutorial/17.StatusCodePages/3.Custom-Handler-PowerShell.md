---
title: Custom Handler (PowerShell)
parent: Status Code Pages
nav_order: 3
---

# Custom Handler (PowerShell)

Handle status codes with a PowerShell ScriptBlock that logs and returns a JSON error payload.

## Full source

File: [`pwsh/tutorial/examples/17.3-StatusCodePages-CustomPowerShell.ps1`][17.3-StatusCodePages-CustomPowerShell.ps1]

```powershell
{% include examples/pwsh/17.3-StatusCodePages-CustomPowerShell.ps1 %}
```

## Step-by-step

1. Logging: Register a console logger.
2. Handler: Create a ScriptBlock reading `$Context` to build a JSON payload.
3. Middleware: Enable StatusCodePages with `-ScriptBlock`.
4. Routes: Map `/hello` and demo routes for 404/500/403/401.
5. Start: Apply configuration and start the server.

## Try it

```powershell
curl -i http://127.0.0.1:5000/error
```

## References

- [Enable-KrStatusCodePage](/pwsh/cmdlets/Enable-KrStatusCodePage)
- [Write-KrLog](/pwsh/cmdlets/Write-KrLog)
- [Write-KrJsonResponse](/pwsh/cmdlets/Write-KrJsonResponse)

---

### Previous / Next

Previous: [Custom Options](./2.Custom-Options.md)
Next: [Custom Handler (C# Inline)](./4.Custom-Handler-CSharp-Inline.md)

[17.3-StatusCodePages-CustomPowerShell.ps1]: /pwsh/tutorial/examples/17.3-StatusCodePages-CustomPowerShell.ps1
