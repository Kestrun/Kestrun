---
layout: default
parent: File and Form Uploads
title: application/x-www-form-urlencoded forms
nav_order: 3
---

# application/x-www-form-urlencoded forms

Parse classic HTML form posts with urlencoded bodies.

## Full source

File: [`pwsh/tutorial/examples/22.3-UrlEncoded.ps1`][22.3-UrlEncoded.ps1]

```powershell
{% include examples/pwsh/22.3-UrlEncoded.ps1 %}
```

## Step-by-step

1. Logger: Enable console logging.
2. Server: Create the host and bind a listener.
3. Options: Opt in to `application/x-www-form-urlencoded` via `AllowedRequestContentTypes`.
4. Route: Add `/form` with `Add-KrFormRoute`.
5. Response: Return parsed fields as JSON.

## Try it

```powershell
$body = 'name=Kestrun&role=admin&role=maintainer'
Invoke-RestMethod -Method Post -Uri 'http://127.0.0.1:5000/form' -ContentType 'application/x-www-form-urlencoded' -Body $body
```

```bash
curl -X POST -H "Content-Type: application/x-www-form-urlencoded" -d "name=Kestrun&role=admin&role=maintainer" http://127.0.0.1:5000/form
```

## Expected output

```json
{
  "fields": {
    "name": ["Kestrun"],
    "role": ["admin", "maintainer"]
  }
}
```

## Notes

- Content types: `Add-KrFormRoute` defaults to `multipart/form-data` only; this script opts in to `application/x-www-form-urlencoded`.
- Limits: `MaxFieldValueBytes` bounds each field value.
- Security: Request body size can be capped via `MaxRequestBodyBytes`.
- Logging: Parser logs metadata without field values.

## Troubleshooting

- 415 / Unsupported Content-Type: Ensure the request `Content-Type` is `application/x-www-form-urlencoded` and the route options allow it.
- Missing multi-values: Repeat the key (e.g. `role=admin&role=maintainer`).

## References

- [Add-KrFormRoute][Add-KrFormRoute]
- [New-KrServer][New-KrServer]
- [Add-KrEndpoint][Add-KrEndpoint]
- [Enable-KrConfiguration][Enable-KrConfiguration]
- [Write-KrJsonResponse][Write-KrJsonResponse]

---

### Previous / Next

{: .fs-4 .fw-500}

Previous: [Multiple files (same field name)](./22.2-Multiple-Files)
Next: [multipart/mixed ordered parts](./22.4-Multipart-Mixed)

[22.3-UrlEncoded.ps1]: /pwsh/tutorial/examples/22.3-UrlEncoded.ps1
[Add-KrFormRoute]: /pwsh/cmdlets/Add-KrFormRoute
[New-KrServer]: /pwsh/cmdlets/New-KrServer
[Add-KrEndpoint]: /pwsh/cmdlets/Add-KrEndpoint
[Enable-KrConfiguration]: /pwsh/cmdlets/Enable-KrConfiguration
[Write-KrJsonResponse]: /pwsh/cmdlets/Write-KrJsonResponse
